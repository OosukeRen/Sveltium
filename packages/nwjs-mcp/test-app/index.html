<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NW.js MCP Test App</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
    }
    .section {
      background: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h2 {
      margin-top: 0;
      color: #555;
      font-size: 18px;
    }
    button {
      padding: 8px 16px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    button:hover {
      background: #0056b3;
    }
    button.danger {
      background: #dc3545;
    }
    button.danger:hover {
      background: #c82333;
    }
    button.success {
      background: #28a745;
    }
    button.success:hover {
      background: #1e7e34;
    }
    input[type="text"], input[type="email"], textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    select {
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }
    .checkbox-row label {
      margin: 0;
    }
    #output {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
    .counter {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .counter span {
      font-size: 24px;
      font-weight: bold;
      min-width: 50px;
      text-align: center;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      padding: 8px;
      background: #f8f9fa;
      margin-bottom: 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>NW.js MCP Test App</h1>

  <div class="section">
    <h2>Buttons</h2>
    <button id="btn-primary" onclick="log('Primary button clicked')">Primary Action</button>
    <button id="btn-secondary" onclick="log('Secondary button clicked')">Secondary</button>
    <button id="btn-danger" class="danger" onclick="log('Danger button clicked')">Delete</button>
    <button id="btn-success" class="success" onclick="log('Success button clicked')">Submit</button>
  </div>

  <div class="section">
    <h2>Form Inputs</h2>
    <label for="name">Name</label>
    <input type="text" id="name" placeholder="Enter your name">

    <label for="email">Email</label>
    <input type="email" id="email" placeholder="Enter your email">

    <label for="message">Message</label>
    <textarea id="message" rows="3" placeholder="Enter your message"></textarea>

    <label for="category">Category</label>
    <select id="category">
      <option value="">Select a category</option>
      <option value="general">General</option>
      <option value="support">Support</option>
      <option value="feedback">Feedback</option>
    </select>

    <div class="checkbox-row">
      <input type="checkbox" id="agree">
      <label for="agree">I agree to the terms</label>
    </div>

    <button onclick="submitForm()">Submit Form</button>
  </div>

  <div class="section">
    <h2>Counter</h2>
    <div class="counter">
      <button onclick="changeCount(-1)">-</button>
      <span id="count">0</span>
      <button onclick="changeCount(1)">+</button>
    </div>
  </div>

  <div class="section">
    <h2>List Items</h2>
    <ul id="item-list">
      <li>Item 1 - Click to select</li>
      <li>Item 2 - Click to select</li>
      <li>Item 3 - Click to select</li>
    </ul>
  </div>

  <div class="section">
    <h2>Console Output</h2>
    <div id="output">(output will appear here)</div>
    <button onclick="clearOutput()">Clear</button>
  </div>

  <script>
    var count = 0

    function log(message) {
      var output = document.getElementById('output')
      var timestamp = new Date().toLocaleTimeString()
      output.textContent += '[' + timestamp + '] ' + message + '\n'
      output.scrollTop = output.scrollHeight
      console.log(message)
    }

    function changeCount(delta) {
      count += delta
      document.getElementById('count').textContent = count
      log('Count changed to: ' + count)
    }

    function submitForm() {
      var name = document.getElementById('name').value
      var email = document.getElementById('email').value
      var message = document.getElementById('message').value
      var category = document.getElementById('category').value
      var agreed = document.getElementById('agree').checked

      log('Form submitted:')
      log('  Name: ' + (name || '(empty)'))
      log('  Email: ' + (email || '(empty)'))
      log('  Message: ' + (message || '(empty)'))
      log('  Category: ' + (category || '(none)'))
      log('  Agreed: ' + agreed)
    }

    function clearOutput() {
      document.getElementById('output').textContent = ''
    }

    // Add click handlers to list items
    var listItems = document.querySelectorAll('#item-list li')
    for (var i = 0; i < listItems.length; i++) {
      (function(li, index) {
        li.addEventListener('click', function() {
          var allItems = document.querySelectorAll('#item-list li')
          for (var j = 0; j < allItems.length; j++) {
            allItems[j].style.background = '#f8f9fa'
            allItems[j].style.color = ''
          }
          li.style.background = '#007bff'
          li.style.color = 'white'
          log('Selected: Item ' + (index + 1))
        })
      })(listItems[i], i)
    }

    // Initial log
    log('Test app loaded')

    // Connect to MCP server (auto-spawns if not running)
    try {
      var mcp = require('../src/client')
      mcp.init({
        name: 'Test App',
        port: 3940,
        window: window
      })
      log('MCP client initializing (auto-spawns server if needed)')
    } catch (err) {
      log('MCP client failed: ' + err.message)
      console.error(err)
    }
  </script>
</body>
</html>
